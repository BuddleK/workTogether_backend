<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Care">
	<select id="login" parameterType="UserLoginDTO" resultType="int">
		SELECT u.users_number
		FROM tbl_users u
		JOIN tbl_care_member c ON c.users_number = u.users_number
		WHERE u.users_id = #{usersId}
		AND u.users_password = #{usersPassword}
		AND u.users_type = 'C'
	</select>
	<insert id="sign" parameterType="CareSginDTO">
		INSERT INTO tbl_care_member (
			care_number, users_name, users_email,
			users_phone, users_postsal_code,
			users_address_line1, users_address_line2,
			care_intro_text,
			care_certificate_files_num, care_passbook_files_num,
			care_profiles_photo_number, care_accept, users_number
		) VALUES (
			seq_care_member.nextval, #{usersName}, #{usersEmail},
			#{usersPhone}, #{usersPostsalCode}, #{usersAddressLine1}, #{usersAddressLine2},
			#{careIntroText}, #{careCertificateFilesNum}, #{carePassbookFilesNum},
			#{careProfilesPhotoNumber}, #{careAccept}, #{usersNumber}
		)
	</insert>

	<select id="findId" parameterType="FindIdDTO" resultType="int">
		SELECT u.users_id
		FROM tbl_users u
		JOIN tbl_care_member c ON c.users_number = u.users_number
		WHERE c.users_name = #{usersName}
		AND c.users_phone = #{usersPhone}
		AND u.users_type = #{usersType}
	</select>
	<select id="findPw" parameterType="FindPwDTO" resultType="int">
		SELECT u.users_password
		FROM tbl_users u
		JOIN tbl_care_member c ON c.users_number = u.users_number
		WHERE c.users_name = #{usersName} 
		AND c.users_phone = #{usersPhone} 
		AND u.users_id = #{usersId}
		AND u.users_type = #{usersType}
	</select>
	<select id="checkId" parameterType="string" resultType="int">
		SELECT count(*)
		FROM tbl_users
		WHERE users_id = #{usersId}
	</select>
	<select id="checkEmail" parameterType="string" resultType="int">
		SELECT count(*)
		FROM tbl_care_member
		WHERE users_email = #{usersEmail}
	</select>
</mapper>