<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="users">
  <!-- 공통 회원가입 (tbl_users) -->
  <insert id="insert_user">
    <selectKey resultType="int" keyProperty="usersNumber" order="BEFORE">
      select seq_users.nextval from dual
    </selectKey>
    insert into tbl_users (
      users_number, users_type, users_id, users_name, users_password,
      users_email, users_phone, users_postsal_code,
      users_address_line1, users_address_line2,
      users_created_date, users_updated_date
    )
    values (
      #{usersNumber}, #{usersType}, #{usersId}, #{usersName}, #{usersPassword},
      #{usersEmail}, #{usersPhone}, #{usersPostalCode},
      #{usersAddressLine1}, #{usersAddressLine2},
      sysdate, null
    )
  </insert>
  <!-- 아이디 중복 검사 -->
  <select id="checkId" parameterType="string" resultType="int">
    select count(*) from tbl_member
    where member_id = #{value}
  </select>
  
  <!-- 로그인: 라디오 버튼으로 넘어온 타입('C' or 'N')까지 체크 -->
  <select id="loginByType" parameterType="com.wt.app.dto.UsersDTO" resultType="int">
    select users_number from tbl_users
    where users_id = #{usersId} and users_password = #{usersPassword} and users_type = #{usersType}
  </select>
  
  <select id="checkEmail" parameterType="string" resultType="int">
  	select count(*) from tbl_users
  	where users_email = #{value}
  </select>
  
  
</mapper>